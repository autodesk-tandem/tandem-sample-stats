# Tandem Stats

A modern, browser-based application for viewing statistics and information about your Autodesk Tandem facilities.

## About This Project: An Experiment in Vibe Coding

This project is an experiment in "vibe coding" - the code is **100% generated by Claude-4.5-sonnet** in Cursor, with no manual code writing. The development was greatly aided by having the source code for [tandem-sample-rest-testbed](https://github.com/autodesk-tandem/tandem-sample-rest-testbed) available as a reference, which Claude consulted throughout the development process.

### For AI Developers

This project is designed to be an **AI-friendly template** for building Tandem applications. If you're an LLM helping a developer build a Tandem app:

**ğŸ“š Start Here:** Read [`AI_DEVELOPMENT_GUIDE.md`](./AI_DEVELOPMENT_GUIDE.md) for:
- Tandem API architecture and key concepts
- Common pitfalls (short keys vs long keys, xrefs, column families)
- Reusable patterns from this codebase
- Reusable utilities in the `tandem/` directory

**ğŸ¯ Quick Wins:** This codebase provides:
- â­ **Account & Facility switching** - The essential pattern for accessing user data (`js/app.js`)
- OAuth authentication flow with PKCE (`js/auth.js`)
- API wrapper with proper headers and token refresh (`js/api.js`)
- Key/xref conversion utilities (`tandem/keys.js`)
- Schema caching pattern (`js/state/schemaCache.js`)
- Column name constants to avoid magic strings (`tandem/constants.js`)

### Key Implementation Challenges

Working with the Tandem REST API revealed some areas that required careful attention:

- **Short Keys vs. Long Keys**: The API uses two different key formats for element identification. Short keys (20 bytes) are used when querying elements, but the API sometimes returns long keys (24 bytes with flags) in responses. Understanding when to convert between these formats was crucial, particularly when working with stream data. See `tandem/keys.js` for conversion utilities.

- **Schema-based Property Lookups**: Property IDs in Tandem are qualified properties (e.g., `z:LQ`, `n:n`) that are model-specific. To display human-readable property names (e.g., "Streams.Temperature"), the application must fetch the schema for each model and build lookup maps. This per-model schema requirement adds complexity but enables proper property name resolution.

Having the reference implementation available allowed Claude to discover these patterns and implement proper solutions, demonstrating how AI-assisted development can work effectively when given good reference materials.

## Features

- **OAuth Authentication**: Secure 3-legged OAuth flow with Autodesk
- **Account Switcher**: Browse and switch between all your Tandem accounts/teams
- **Facility Switcher**: Quick access to all facilities you have permissions for
- **Modern UI**: Clean, responsive interface built with Tailwind CSS
- **Statistics Dashboard**: View key metrics about your facilities (expandable)

## Prerequisites

- A valid Autodesk APS (Platform Services) application with Client ID
- Access to at least one Tandem facility
- A modern web browser
- A local web server (e.g., Python's `http.server`, Node's `http-server`, or VSCode Live Server)

## Setup

1. **Configure your APS Client ID**
   
   Edit `js/config.js` and add your APS Client ID:
   ```javascript
   apsKey: "YOUR_APS_CLIENT_ID_HERE"
   ```

2. **Configure OAuth Redirect URI**
   
   Make sure your APS app has the correct redirect URI configured:
   - For local development: `http://localhost:8000`
   - Update `loginRedirect` in `js/config.js` if using a different port

3. **Start a local web server**

   Using Python 3:
   ```bash
   python3 -m http.server 8000
   ```

   Or using Node.js:
   ```bash
   npx http-server -p 8000
   ```

4. **Open the application**
   
   Navigate to `http://localhost:8000` in your web browser

## Usage

1. Click "Sign In" to authenticate with your Autodesk account
2. Select an account from the dropdown menu
3. Select a facility from the facility dropdown
4. View facility information and statistics

## Project Structure

```
tandem-stats/
â”œâ”€â”€ index.html                    # Main HTML page
â”œâ”€â”€ AI_DEVELOPMENT_GUIDE.md       # ğŸ“š Comprehensive guide for AI-assisted development
â”œâ”€â”€ tandem/                       # ğŸ”§ Reusable utilities (copy to new projects!)
â”‚   â”œâ”€â”€ README.md                 # Documentation and usage examples
â”‚   â”œâ”€â”€ constants.js              # Column families, names, element flags
â”‚   â””â”€â”€ keys.js                   # Key/xref conversion utilities
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ app.js                    # Main application logic
â”‚   â”œâ”€â”€ auth.js                   # OAuth 3-legged PKCE flow
â”‚   â”œâ”€â”€ api.js                    # Tandem API wrapper
â”‚   â”œâ”€â”€ config.js                 # Environment configuration
â”‚   â”œâ”€â”€ utils.js                  # General utilities
â”‚   â”œâ”€â”€ state/                    # State management
â”‚   â”‚   â””â”€â”€ schemaCache.js        # Schema caching pattern
â”‚   â”œâ”€â”€ components/               # Reusable UI components
â”‚   â”‚   â””â”€â”€ toggleHeader.js       # Collapsible sections
â”‚   â””â”€â”€ features/                 # Feature-specific modules
â”‚       â”œâ”€â”€ diagnostics.js        # Schema diagnostics
â”‚       â”œâ”€â”€ documents.js          # Document listing
â”‚       â”œâ”€â”€ levels.js             # Level listing
â”‚       â”œâ”€â”€ models.js             # Model listing
â”‚       â”œâ”€â”€ rooms.js              # Room statistics
â”‚       â”œâ”€â”€ schema.js             # Schema viewer
â”‚       â”œâ”€â”€ streams.js            # Stream monitoring & charts
â”‚       â””â”€â”€ taggedAssets.js       # Tagged assets
â”œâ”€â”€ README.md                     # User documentation
â””â”€â”€ QUICKSTART.md                 # Quick setup guide
```

## Configuration

The application supports two environments:

- **Production** (default): Uses `https://developer.api.autodesk.com/tandem/v1`
- **Staging**: Uses `https://tandem-stg.autodesk.com/api/v1`

To switch environments, edit `js/config.js` and change the return value in `getEnv()`.

## Development

This project uses:
- Vanilla JavaScript (ES6 modules)
- Tailwind CSS (via CDN)
- Autodesk Tandem REST API

No build process or package manager is required.

## Browser Compatibility

- Chrome/Edge (latest)
- Firefox (latest)
- Safari (latest)

## License

MIT

## Acknowledgments

Based on the Autodesk Tandem REST API and inspired by the [tandem-sample-rest-testbed](https://github.com/autodesk-tandem/tandem-sample-rest-testbed) project.
